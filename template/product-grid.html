<!doctype html>
<html lang="en">

<head>

    <!--====== Required meta tags ======-->
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--====== Title ======-->
    <title>HaFood</title>

    <!--====== Bootstrap css ======-->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">

    <!--====== Pe Icon 7 Stroke css ======-->
    <link rel="stylesheet" href="assets/css/Pe-icon-7-stroke.css">

    <!--====== Ion Icons css ======-->
    <link rel="stylesheet" href="assets/css/ionicons.min.css">

    <!--====== Magnific Popup css ======-->
    <link rel="stylesheet" href="assets/css/magnific-popup.css">

    <!--====== Slick css ======-->
    <link rel="stylesheet" href="assets/css/slick.css">

    <!--====== Animate css ======-->
    <link rel="stylesheet" href="assets/css/animate.min.css">

    <!--====== Nice Select css ======-->
    <link rel="stylesheet" href="assets/css/nice-select.css">

    <!--====== Default css ======-->
    <link rel="stylesheet" href="assets/css/default.css">

    <!--====== Style css ======-->
    <link rel="stylesheet" href="assets/css/style.css">


</head>

<body>

    <!--====== PRELOADER  PART START ======-->

    <div id="preloader">
        <div id="loader">
            <span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
    </div>

    <!--====== PRELOADER  PART ENDS ======-->


    <!--====== SHOPPING CART PART START ======-->

    <div class="shopping-cart-wrapper">
        <div class="shopping-cart-canvas">
            <div class="shopping_cart">
                <div class="shopping_cart-top-bar d-flex justify-content-between">
                    <h6>Shopping Cart</h6>
                    <button class="shopping-cart-close">
                        <i class="ion ion-md-add"></i>
                    </button>
                </div><!-- shopping cart top bar -->

                <div class=" pt-25 ">
                    <select id="mealTime">
                        <option value="0">立即就餐</option>
                        <option value="11">今日11点</option>
                        <option value="12">今日12点</option>
                        <option value="13">今日13点</option>
                        <option value="17">今日17点</option>
                        <option value="18">今日18点</option>
                        <option value="19">今日19点</option>
                    </select>
                </div>

                <div class="shopping_cart-list-items mt-30" style="overflow-y:scroll">
                    <ul id="shoppingCartList">
                        <!--
                        <li>
                            <div class="single-shopping-cart media">

                                <div class="cart-image">
                                    <img src="assets/images/cart-1.jpg" alt="Cart">
                                </div>

                                <div class="cart-content media-body pl-15">
                                    <h4>Banana</h4>
                                    <span class="price">99.00</span>
                                    <h5><a href="javascript:void(0)" onclick="removeSingleProduct(this)">Remove</a></h5>
                                </div>

                                <div class="product-quantity">
                                    <button type="button" class="sub" onclick="subProduct(this)">-</button>
                                    <input type="text" value="1" />
                                    <button type="button" class="add" onclick="addProduct(this)">+</button>
                                </div>

                            </div>
                        </li>
                        -->
                    </ul>
                </div> <!-- shopping_cart list items -->
                <div class="shopping_cart-btn">
                    <div class="total pt-35 d-flex justify-content-between">
                        <h5>Subtotal:</h5>
                        <p id="sumPrice">0</p>
                    </div>
                    <div class="cart-btn pt-25">
                        <a class="main-btn" href="#" onclick="sendOrder()">Checkout</a>

                    </div>
                </div>
            </div> <!-- shopping_cart -->
        </div>
        <div class="overlay"></div>
    </div>

    <!--====== SHOPPING CART PART ENDS ======-->


    <!--====== HEADER  PART START ======-->

    <header class="header-area">
        <div class="navigation navigation-2 navigation-page fixed-top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <nav class="navbar navbar-expand-lg">
                            <a class="navbar-brand" href="index.html">
                                <img src="assets/images/logo.png" alt="Logo">
                            </a> <!-- Logo -->

                            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="toggler-icon"></span>
                                <span class="toggler-icon"></span>
                                <span class="toggler-icon"></span>
                            </button> <!-- navbar-toggler -->

                            <div class="collapse navbar-collapse sub-menu-bar" id="navbarSupportedContent">
                                <ul class="navbar-nav mr-auto">
                                    <li class="nav-item"><a href="index.html">首页</a></li>
                                   
                                    <li class="nav-item"><a href="product-grid.html">商品列表</a></li>
                                    <li class="nav-item"><a class="page-scroll" href="#" onclick="showUnfinishedOrder()">未完成订单</a></li>
                                    <li class="nav-item"><a class="page-scroll" href="#" onclick="showAllOrder()">全部订单</a></li>
                                </ul>
                            </div> <!-- navbar collapse -->
                            <div class="navbar-icon d-none d-sm-block">
                                <ul>
                                    
                                    <li><a class="shopping-cart-open" href="#"><i class="pe-7s-cart"></i></a></li>
                                </ul>
                            </div>
                        </nav> <!-- navbar -->
                    </div>
                </div> <!-- row -->
            </div> <!-- container -->
        </div> <!-- navigation -->
    </header>

    <!--====== HEADER  PART ENDS ======-->

    <!--====== PAGE TITLE  PART START ======-->

    <section class="page-title-area d-flex align-items-center bg_cover" style="background-image: url(assets/images/page-title-bg.jpg)">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="page-title-item text-center">
                        <!--====== change title when click ======-->
                        <h3 class="title" id="pageTitle">Product Grid</h3>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="index">Home</a></li>
                                <!--====== change title when click ======-->
                                <li id="secondTitle" class="breadcrumb-item active" aria-current="page">Product Grid</li>
                            </ol>
                        </nav>
                    </div> <!-- page title item -->
                </div>
            </div> <!-- row -->
        </div> <!-- row -->
        <div class="page-title-shape">
            <img src="assets/images/banner-shape.png" alt="shape">
        </div> <!-- page title shape -->
    </section>

    <!--====== PAGE TITLE  PART ENDS ======-->

    <!--====== PRODUCT DETAILS PART START style="display:none;" ======-->

    <section id="productDetail" style="display:none;" class="product-details-area pt-30 pb-90">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-md-5">
                    <div id="bigPicture" class="product-details-thumb mt-35">
                        <!--====== big picture ======-->
                        <img src="assets/images/product-details-thumb-1.jpg" alt="product details">
                    </div>
                </div>

                <div class="col-lg-6 col-md-7">
                    <div class="product-details-content mt-30">
                        <div class="product-details-title">
                            <h4 class="title" id="productName">Grape</h4>
                        </div>

                        <div class="product-details-con">
                            <span id="productPrice">$50.00</span>
                            <p id="productInfo">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.</p>
                        </div>

                        <div class="product-details-cart d-flex align-items-center">
                            <div class="product-quantity" id="quantity">
                                <button type="button" id="sub" class="sub">-</button>
                                <input type="text" id="productQuantity" value="1" />
                                <button type="button" id="add" class="add">+</button>
                            </div>
                            <div class="add-cart">
                                <a href="javascript:void(0)" onclick="detailAdd2Cart()">Add to cart</a>
                            </div>
                            <ul>
                                <li><a href="javascript:void(0)" onclick="add2Fav()"><i class="ion ion-md-heart-empty"></i></a></li>
                                <li><a href="javascript:void(0)" onclick="del2Fav()"><i class="ion ion-ios-repeat"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--====== PRODUCT DETAILS PART ENDS ======-->

    <!--====== CUSTOMER PART START ======-->

    <section id="userComment" class="customer-area customer-about pt-85 pb-145" style="display:none;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="section-title text-center">
                        <h3 class="title">Comments</h3>
                    </div>

                </div>
            </div>

            <div id="comments" class="row customer-active" >
                <!-- 单条评论 -->
                <div class="col-lg-6">
                    <div class="gray-bg mt-30">
                        <div class="customer-item">
                            <img src="assets/images/customer-1.png" alt="customer">
                            <span><b>Adam</b> / Designer</span>
                            <p>“ Lorem ipsum dolor sit </p>
                            <br/>
                            <a style="position: absolute;right: 0;" href="javascript:void(0)">X</a>
                        </div> <!-- customer item -->
                    </div>
                </div>

            </div> <!-- row -->

            <div class="cart-btn pt-25">
					<textarea rows="2" cols="20">
					</textarea>
            </div>

            <div class="container pt-25">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="search-form">
                            <form >
                                <a class="main-btn" href="javascript:void(0)" onclick="addComment()">Submit</a>
                                &nbsp&nbsp
                                <input id="addComment" type="text" placeholder="Add Comments">
                            </form>
                        </div>
                    </div>
                </div> <!-- row -->
            </div> <!-- container -->


        </div> <!-- container -->
    </section>

    <!--====== CUSTOMER PART ENDS ======-->

    <!--====== Order PART START ======-->

    <section id="userOrders" class="customer-area customer-about pt-85 pb-145" style="display:none;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="section-title text-center">
                        <h3 class="title">Orders</h3>
                    </div>

                </div>
            </div>

            <div id="orderList" class="row customer-active" >
                <!-- 单条订单 -->
                <div class="col-lg-6">
                    <div class="gray-bg mt-30">
                        <li><b>订单状态:</b>&nbsp; </li>
                        <li><b>取餐号码:</b>&nbsp; </li>
                        <li><b>支付金额:</b>&nbsp; </li>
                        <li><b>下单时间:</b>&nbsp; </li>
                        <li><b>订单详情:</b>&nbsp; </li>
                    </div>
                </div>

            </div> <!-- row -->

        </div> <!-- container -->
    </section>

    <!--====== Order PART ENDS ======-->



    <!--====== PRODUCT GRID PART START ======-->
    <!--====== change title when click ======-->
    <section id="productGrid" class="product-area product-area-2">
        <div class="container">
            <div class="row align-items-center pt-65 pb-20">
                <div class="col-lg-3 col-md-4">
                    <div class="product-grid-tab d-flex">
                        <span>products </span>
                       
                    </div>
                </div>
                <div class="col-lg-9 col-md-8">
                    <div class="product-grid-select float-left float-md-right">
                        <ul>                            
                            <li>
                                <select id="selectKind">
								    <option value="all">全部种类</option>
                                    <option value="gaiMa">普通盖码</option>
                                    <option value="xiaoChi">特色小吃</option>
                                    <option value="xiaoChao">精致小炒</option>
                                    <option value="tangMian">水饺汤面</option>
                                    <option value="favorite">我的收藏</option>
                                </select>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                    <div id="productList" class="row">
                        <!--====== product list  ======-->
                        <div class="col-lg-3 col-md-4 col-sm-6">
                            <div class="single-product mt-30">
                                <img src="assets/images/product-1.jpg" alt="product">
                                <a href="product-details.html">
                                    <h6 class="title">Grape</h6>
                                </a>
                                <ul>
                                    <li>$15.00</li>
									
                                </ul>
								<h6><a href="javascript:void(0)" onclick="showRegister() ">add</a></h6>
                            </div> <!-- single product -->
                        </div>
                       
                    </div> <!-- row -->
                </div>
                
            </div>
        </div> <!-- container -->
    </section>

    <!--====== PRODUCT GRID PART ENDS ======-->

    <!--====== BLOG GRID PART START ======-->

    <div class="blog-list-area pt-25 pb-90">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-12">
                    <div class="blog-list-item">
                        <div class="pagination-area d-flex justify-content-between mt-60 pt-40">
                            
                            <!-- <div class="pagination-item-2">
                                <ul>
                                    <li><a href="#"><i class="ion ion-ios-arrow-back"></i></a></li>
                                    <li><a href="#"><i class="ion ion-ios-arrow-forward"></i></a></li>
                                </ul>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--====== BLOG GRID PART ENDS ======-->

    <!--====== FOOTER PART START ======-->

    <section class="footer-area gray-bg pt-60 pb-85">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-5">
                    <div class="footer-item-1 mt-30">
                        <a href="index.html"><img src="assets/images/logo-2.png" alt="logo"></a>
                        <span>Copyright &copy; 2019.Company name All rights reserved.</span>
                        <ul>
                            <li><a href="#">Quality policy</a></li>
                            <li><a href="#">Customer Policy </a></li>
                            <li><a href="#">About Us</a></li>
                        </ul>
                        <div class="footer-info">
                            <ul>
                                <li><i class="ion ion-md-pin"></i> 123 New Design Str, ABC Building, <br> Melbourne, Australia</li>
                                <li><i class="ion ion-ios-mail"></i>example@gmail.com</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 offset-lg-2 col-md-2 col-sm-4">
                    <div class="footer-social mt-30">
                        <h5 class="title">Social Links</h5>
                        <ul>
                            <li><a href="https://www.facebook.com/info.tanver">Facebook</a></li>
                            <li><a href="#">Twitter</a></li>
                            <li><a href="#">Instagram</a></li>
                            <li><a href="skype:live:taherul.islam_1">Skype</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-4 col-md-5 col-sm-8">
                    <div class="footer-item-2 mt-30">
                        <h5 class="title">Newsletters</h5>
                        <form action="#">
                            <div class="input-box mt-25">
                                <input type="email" placeholder="Your email">
                            </div>
                            <div class="input-box mt-25">
                                <button class="main-btn">Submit <i class="ion ion-ios-send"></i></button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--====== FOOTER PART ENDS ======-->

    <!--====== BACK TO TOP ======-->
    <div class="back-to-top">
        <a href="">
            <i class="ion ion-md-arrow-up"></i>
        </a>
    </div>
    <!--====== BACK TO TOP ======-->


    <!--====== jquery js ======-->
    <script src="assets/js/vendor/modernizr-3.6.0.min.js"></script>
    <script src="assets/js/vendor/jquery-1.12.4.min.js"></script>

    <!--====== Bootstrap js ======-->
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/popper.min.js"></script>

    <!--====== Slick js ======-->
    <script src="assets/js/slick.min.js"></script>

    <!--====== Isotope js ======-->
    <script src="assets/js/isotope.pkgd.min.js"></script>

    <!--====== Images Loaded js ======-->
    <script src="assets/js/imagesloaded.pkgd.min.js"></script>

    <!--====== Magnific Popup js ======-->
    <script src="assets/js/jquery.magnific-popup.min.js"></script>

    <!--====== Nice Select js ======-->
    <script src="assets/js/jquery.nice-select.min.js"></script>

    <!--====== Ajax Contact js ======-->
    <script src="assets/js/ajax-contact.js"></script>

    <!--====== Main js ======-->
    <script src="assets/js/main.js"></script>
	
<script type="text/javascript">
    var productLists = [];
    var sumPrice=0.0;
    var chooseId = 0;
    //购物车部分start
    function addProduct(e){
        var count=parseInt($(e).prev().val());
        $(e).prev().val(count+1);
        var priceStr=$(e).parent().prev().find("span").text();
        var priceFloat=parseFloat(priceStr);
        sumPrice=sumPrice+priceFloat;
        $("#sumPrice").text(sumPrice);
    }

    function subProduct(e){
        var count=parseInt($(e).next().val());
        if(count==1){
            //alert("least 1");
        }else{
            $(e).next().val(count-1);
            var priceStr=$(e).parent().prev().find("span").text();
            var priceFloat=parseFloat(priceStr);
            sumPrice=sumPrice-priceFloat;
            $("#sumPrice").text(sumPrice);
        }
    }

    function removeSingleProduct(e){
        var count=$(e).parent().parent().next().find("input").val();
        var priceStr=$(e).parent().prev().text();
        var priceFloat=parseFloat(priceStr);
        sumPrice=sumPrice-priceFloat*count;
        $("#sumPrice").text(sumPrice);
        $(e).parent().parent().parent().parent().remove();
    }

    function add2Cart(e){//gird页面添加商品到购物车
        var productId = $(e).parent().prev().prev().find("h6").attr("id");
        alert("add success,id="+productId);
        var product = productLists[productId];
        var content = $("#shoppingCartList").html();
        sumPrice=sumPrice+product.Price;
        $("#sumPrice").text(sumPrice);
        content=content+
             "<li><div class='single-shopping-cart media'>"+
            //"<div class='cart-image'>"+
            //"<img src='assets/images/cart-1.jpg' alt='Cart'> </div>"+

            "<div class='cart-content media-body pl-15'>"+
            "<h4>"+product.FoodName+"</h4>"+
            "<span class='price'>"+product.Price+"</span>"+
            "<h5><a href='javascript:void(0)' onclick='removeSingleProduct(this)'>Remove</a></h5></div>"+

            "<div class='product-quantity'>"+
            "<button type='button' class='sub' onclick='subProduct(this)'>-</button>"+
            "<input type='text' value='1' />"+
            "<button type='button' class='add' onclick='addProduct(this)'>+</button>"+
            "</div></div> <!-- single shopping cart --></li>";
        $("#shoppingCartList").html(content);
    }

    function detailAdd2Cart() {//详情页添加到购物车
        alert("add success,id="+chooseId);
        var product = productLists[chooseId];
        var count = $("#productQuantity").val();
        var content = $("#shoppingCartList").html();
        sumPrice=sumPrice+product.Price*count;
        $("#sumPrice").text(sumPrice);
        content=content+
            "<li><div class='single-shopping-cart media'>"+
            //"<div class='cart-image'>"+
            //"<img src="+product.Picture+" alt='Cart'> </div>"+

            "<div class='cart-content media-body pl-15'>"+
            "<h4>"+product.FoodName+"</h4>"+
            "<span class='price'>"+product.Price+"</span>"+
            "<h5><a href='javascript:void(0)' onclick='removeSingleProduct(this)'>Remove</a></h5></div>"+

            "<div class='product-quantity'>"+
            "<button type='button' class='sub' onclick='subProduct(this)'>-</button>"+
            "<input type='text' value="+count+" />"+
            "<button type='button' class='add' onclick='addProduct(this)'>+</button>"+
            "</div></div> <!-- single shopping cart --></li>";
        $("#shoppingCartList").html(content);
    }
    //购物车部分end

    //查看商品详情
    function showDetail(e){
        $("#productDetail").show();
        $("#userComment").show();
        $("#productGrid").hide();

        var productId = $(e).attr("id");
        chooseId = productId;
        var product = productLists[productId];
        //修改相关属性 pageTitle secondTitle bigPicture productInfo productName productPrice
        //巨坑 使用attr修改src在ie页面无法成功

        var src="<img  src="+product.Picture+" alt='product details'>";
        $("#pageTitle").text("Product Details");
        $("#secondTitle").text("Product Details");
        $("#bigPicture").html(src);
        $("#productInfo").text(product.Brief);
        $("#productName").text(product.FoodName);
        $("#productPrice").text(product.Price);
        //加载评论
        loadComments();
    }

    //分类查菜品部分
    function showFoods(dataResult){
        var content="";
        $.each(dataResult, function(i, val){
            content=content+"<div class='col-lg-3 col-md-4 col-sm-6'>"+
                " <div class='single-product mt-30'>"+
                "<img src='"+val.Picture+"' alt='product'>"+
                "<a href='javascript:void(0)'>"+
                "<h6 id="+i+" class='title' onclick='showDetail(this)'>"+val.FoodName+"</h6></a>"+
                "<ul><li>￥"+val.Price+"</li></ul>"+
                "<h6><a href='javascript:void(0)' onclick='add2Cart(this)'>Add</a></h6></div></div>";

        });

        $("#productList").html(content);
    }

    function showFoodByKinds(kind){
        var reqUrl="/custom/searchByKinds/"+kind;
        //alert(reqUrl);
        $.ajax({
            type: "POST",
            dataType: "json",
            url: reqUrl,
            data: {
                "message":"kind"
            },
            success: function (dataResult) {
                productLists = dataResult;
                showFoods(dataResult);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                var failMsg="find food by kinds fail,status:"+XMLHttpRequest.status+",textStatus:"+textStatus;
                alert(failMsg);
            }
        });
    }
    //增删收藏
    function add2Fav(){
        var product = productLists[chooseId];
        var reqUrl= "/custom/add2fav/"+product.fid;
        alert(reqUrl)
        $.ajax({
            type: "POST",
            dataType: "json",
            url: reqUrl,
            data: {
                "message":"fav"
            },
            success: function (dataResult) {
                alert("add fav success");
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                var failMsg="add2Fav fail,status:"+XMLHttpRequest.status+",textStatus:"+textStatus;
                alert(failMsg);
            }
        });
    }

    function del2Fav(){
        var product = productLists[chooseId];
        var reqUrl= "/custom/delFav/"+product.fid;
        $.ajax({
            type: "POST",
            dataType: "json",
            url: reqUrl,
            data: {
                "message":"del"
            },
            success: function (dataResult) {
                alert("del fav success");
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                var failMsg="del2Fav fail,status:"+XMLHttpRequest.status+",textStatus:"+textStatus;
                alert(failMsg);
            }
        });
    }
    //发送订单
    function sendOrder(){
        var detail = new Map();
        $('#shoppingCartList li').each(function() {
            var name=$(this).find("h4").text();
            var num=$(this).find(":text").val();
            detail.set(name,num);
        })
        var order={
            'sumPrice':sumPrice+'',
            'detail': MapTOJson(detail),
            'mealTime': $("#mealTime").val()
        };
        alert(JSON.stringify(order));
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "/custom/sendOrder",
            data: JSON.stringify(order),
            success: function (dataResult) {
                alert("order success");
                $("#shoppingCartList").html("");
                $("#sumPrice").text(0);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                var failMsg="sendOrder fail,status:"+XMLHttpRequest.status+",textStatus:"+textStatus;
                alert(failMsg);
            }
        });
    }

    function MapTOJson(m) {
        var str = '{';
        var i = 1;
        m.forEach(function (item, key, mapObj) {
            if (mapObj.size == i) {
                str += '"' + key + '":"' + item + '"';
            } else {
                str += '"' + key + '":"' + item + '",';
            }
            i++;
        });
        str += '}';
        //console.log(str);
        return str;
    }

    //评论相关
    //刷新评论
    function loadCommentsBasic(url,sendData){

        $.ajax({
            type: "POST",
            dataType: "json",
            url: url,
            data: sendData,
            success: function (dataResult) {
                var content="";
                $.each(dataResult, function(i, val){
                        content=content+
                            "<div class=\"col-lg-6 \">\n" +
                            "   <div class=\"gray-bg mt-30\">\n" +
                            "      <div class=\"customer-item\">\n" +
                            "          <img src=\"assets/images/customer-1.png\" alt=\"customer\">\n" +
                            "          <span><b>"+val.PhoneNumber +"</b></span>  <span>"+val.Ctime+"</span>\n" +
                            "          <p>"+val.Message+" </p>\n" +
                            "          <br/>\n" +
                            "          <a style=\"position: absolute;right: 0;\" href=\"javascript:void(0)\" onclick=\"delComment(this)\">X</a>\n" +
                            "      </div> <!-- customer item -->\n" +
                            "   </div>\n" +
                            "</div>";
                });
                $("#comments").html(content);

            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                var failMsg="loadComments fail,status:"+XMLHttpRequest.status+",textStatus:"+textStatus;
                alert(failMsg);
            }
        });
    }
    //某一道菜的评论
    function loadComments(){
        var sendUrl="/custom/queryComments/"+chooseId;
        loadCommentsBasic(sendUrl,"");
    }
    //添加评论
    function addComment(){
        var sendData={
            "fid":chooseId+"",
            "message":$("#addComment").val()
        };
        var sendUrl="/custom/addComments";
        loadCommentsBasic(sendUrl,JSON.stringify(sendData));
    }
    //删除评论
    function delComment(e){
        var ctime=$(e).prev().prev().prev().text();

        var sendUrl="/custom/delComments";
        var sendData={
            "fid":chooseId+"",
            "ctime":ctime
        };
        loadCommentsBasic(sendUrl,JSON.stringify(sendData));
    }
    //查看订单
    function showUnfinishedOrder() {
        queryOrders("Unfinished Orders","unfinished");
    }
    function showAllOrder() {
        queryOrders("All Orders","all");
    }
    function queryOrders(str,cmd){
        $("#productDetail").hide();
        $("#userComment").hide();
        $("#productGrid").hide();
        $("#userOrders").show();
        $("#pageTitle").text(str);
        $("#secondTitle").text(str);

        var url="/custom/queryOrders/"+cmd;

        $.ajax({
            type: "POST",
            dataType: "json",
            url: url,
            data: "",
            success: function (dataResult) {
                var orderContent = "";
                $.each(dataResult, function(i, val){
                    orderContent=orderContent+
                       " <div class='col-lg-6'>"+
                        "<div class='gray-bg mt-30'>"+
                        "<li><b>订单状态:</b>&nbsp; "+val.State+"</li>"+
                        "<li><b>取餐号码:</b>&nbsp; "+val.MealCode+"</li>"+
                        "<li><b>支付金额:</b>&nbsp; "+val.Price+"</li>"+
                        "<li><b>下单时间:</b>&nbsp; "+val.StartTime+"</li>"+
                        "<li><b>订单详情:</b>&nbsp; "+val.Detail+"</li>"+
                        "</div></div>";
                });
                $("#orderList").html(orderContent);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                var failMsg="queryOrders fail,status:"+XMLHttpRequest.status+",textStatus:"+textStatus;
                alert(failMsg);
            }
        });
    }

    $(function(){
        showFoodByKinds("all");
        //根据种类显示菜品
        $('#selectKind').change(function(){
            //alert($(this).children('option:selected').val());
            var kind=$(this).children('option:selected').val();//这就是selected的值
            showFoodByKinds(kind);
        })
    });

</script>

</body>

</html>

